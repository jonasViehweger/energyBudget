} else if(texture == "clay"){
y <- c(0.276,0.586,1.1,1.43,1.57,1.74,1.95)
} else {
stop("Texture not available. Input either 'sand' or 'clay'")
}
x <- c(0, 5, 10, 15, 20, 30, 43)
# linear interpolation of values
thermal_cond <- approx(x, y, xout = moisture, yleft = NA, yright = y[7])
}
moisture <- c(-4, 0, 2.5, 10, 17, 21, 33, 45)
soil_thermal_cond(moisture)
# fuer Sand mit Hilfe der Bodenfeuchte x (in Vol-%)
#' Title
#'
#' @param moisture
#' @param texture
#'
#' @return
#' @export
#'
#' @examples
soil_thermal_cond <- function(moisture, texture = "sand") {
if(texture == "sand"){
y <- c(0.269,1.46,1.98,2.18,2.31,2.49,2.58)
} else if(texture == "clay"){
y <- c(0.276,0.586,1.1,1.43,1.57,1.74,1.95)
} else {
stop("Texture not available. Input either 'sand' or 'clay'")
}
x <- c(0, 5, 10, 15, 20, 30, 43)
# linear interpolation of values
return(approx(x, y, xout = moisture, yleft = NA, yright = y[7]))
}
soil_thermal_cond(moisture)
# fuer Sand mit Hilfe der Bodenfeuchte x (in Vol-%)
#' Title
#'
#' @param moisture
#' @param texture
#'
#' @return
#' @export
#'
#' @examples
soil_thermal_cond <- function(moisture, texture = "sand") {
if(texture == "sand"){
y <- c(0.269,1.46,1.98,2.18,2.31,2.49,2.58)
} else if(texture == "clay"){
y <- c(0.276,0.586,1.1,1.43,1.57,1.74,1.95)
} else {
stop("Texture not available. Input either 'sand' or 'clay'")
}
x <- c(0, 5, 10, 15, 20, 30, 43)
# linear interpolation of values
therm_cond <- approx(x, y, xout = moisture, yleft = NA, yright = y[7])
return(therm_cond$y)
}
soil_thermal_cond(moisture)
soil_thermal_cond(moisture, texture = "hallo")
devtools::document()
rm(list = c("soil_thermal_cond"))
devtools::document()
devtools::load_all()
?soil_vol_heat_cap
devtools::document()
?soil_vol_heat_cap
devtools::document()
?soil_vol_heat_cap
devtools::document()
?soil_vol_heat_cap
devtools::document()
?soil_vol_heat_cap
devtools::document()
require(devtools)
require(usethis)
use_R("transmission")
use_r("transmission")
data.frame(sum = sum(c(1,2,3,)))
data.frame(sum = sum(c(1,2,3,4)))
data.frame(sum = sum(c(1,2,3,4)),)
data.frame(sum = sum(c(1,2,3,4)), other = 5, final = sum*other)
test <- data.frame(first = 1:5,
second = 5:10)
test <- data.frame(first = 1:5,
second = 6:10)
apply(test, 1, prod)
use_r("solar")
as.POSIXct(date)
as.POSIXlt(date)
date <- "2011-03-27 01:30:00"
as.POSIXlt(date)
as.POSIXct(date)
strftime(as.POSIXlt(date))
strftime(as.POSIXlt(date), format = "%j")
strftime(as.POSIXct(date), format = "%j")
inherits(as.POSIXct("2011-03-27 01:30:00"), "POSIXct")
inherits(as.POSIXct("2011-03-27 01:30:00"), "POSIXlt")
inherits(as.POSIXct("2011-03-27 01:30:00"), "POSIXt")
!inherits(as.POSIXct("2011-03-27 01:30:00"), "POSIXt")
type(as.POSIXct("2011-03-27 01:30:00"))
class(as.POSIXct("2011-03-27 01:30:00"))
lt <- as.POSIXlt(ct)
ct <- as.POSIXct("2011-03-27 01:30:00")
lt <- as.POSIXlt(ct)
ct <- as.POSIXct("2011-03-27 01:30:00")
ct$hour
lt <- as.POSIXlt(ct)
lt$hour
document()
usethis::use_r("terrain")
library(lubridate)
library(dplyr)
source("../00_Toolbox/solar_IR_rad_functions.R")
radiation_data <- read.csv("../03_Sitzung_3/testdatensatz_radbilanz_wiese_caldern.csv") %>%
na.omit()
################# Notwendige Eingaben Atmosphäre
solconst <- 1367            # Mean solar constatnt W/m²
p <- 1000                   # Air pressure in hPa; wenn bekannt, angeben; sonst unten berechnen
oz <- 0.35                  # average Ozon columnar values 0.35 cm
t <- 20.8                   # Temperatur in °C
vis <- 40                   # horizontale Sichtweite in km
################### Notwendige Eingaben Ort und Zeit
gb <- 50.84050277777778
gl <- 8.683303333333333
################## Eingaben Gelaende
h  <- 200           # Gelaendehoehe in m
sky <- 0.8          # Himmelssichtfaktor (sky view factor 0..1); 1, wenn keine Horizontueberschattung; wenn nicht bekannt, rechnen
hex <- 180          # Expositionswinkel 0 = N, 180° = S
hn <- 20            # Hangneigung in Grad (0...90°)
albedo <- 0.15      # Albedo in 0...1
everything <- radiation_data %>%
mutate(
date = dmy_hm(datetime, tz = "Europe/Berlin"),
ut = hour(date)+minute(date)/60+second(date)/3600,
sh = sh(yday(date), ut, gb, gl),
pressure = pp(Ta_2m, h),
exz = exz(yday(date)),
mr = mr(sh),
ma = ma(mr, pressure),
tlu = tlu(ma),
to3 = to3(mr, oz),
pw = pw(pressure,Ta_2m,h),
twv = twv(pw, mr),
tae = tae(vis, ma),
tgas = tgas(ma),
tges = tlu*to3*tgas*tae*twv,
sol_90 = solconst*exz,
sol_sh = sol_90 * sin(sh*(pi/180)),
sol_hor = sol_sh * tges,
sol_ref = albedo * sol_hor,
sol_bal = sol_hor - sol_ref,
)
View(everything)
radiation_data <- read.csv("../03_Sitzung_3/testdatensatz_radbilanz_wiese_caldern.csv") %>%
na.omit()
################# Notwendige Eingaben Atmosphäre
solconst <- 1367            # Mean solar constatnt W/m²
p <- 1000                   # Air pressure in hPa; wenn bekannt, angeben; sonst unten berechnen
oz <- 0.35                  # average Ozon columnar values 0.35 cm
t <- 20.8                   # Temperatur in °C
vis <- 40                   # horizontale Sichtweite in km
################### Notwendige Eingaben Ort und Zeit
gb <- 50.84050277777778
gl <- 8.683303333333333
################## Eingaben Gelaende
h  <- 200           # Gelaendehoehe in m
sky <- 0.8          # Himmelssichtfaktor (sky view factor 0..1); 1, wenn keine Horizontueberschattung; wenn nicht bekannt, rechnen
hex <- 180          # Expositionswinkel 0 = N, 180° = S
hn <- 20            # Hangneigung in Grad (0...90°)
albedo <- 0.15      # Albedo in 0...1
everything <- radiation_data %>%
mutate(
date = dmy_hm(datetime, tz = "Europe/Berlin"),
ut = hour(date)+minute(date)/60+second(date)/3600,
sh = sh(yday(date), ut, gb, gl),
pressure = pp(Ta_2m, h),
exz = exz(yday(date)),
saz = saz(yday(date), ut, gb, gl),
mr = mr(sh),
ma = ma(mr, pressure),
tlu = tlu(ma),
to3 = to3(mr, oz),
pw = pw(pressure,Ta_2m,h),
twv = twv(pw, mr),
tae = tae(vis, ma),
tgas = tgas(ma),
tges = tlu*to3*tgas*tae*twv,
sol_90 = solconst*exz,
sol_sh = sol_90 * sin(sh*(pi/180)),
sol_hor = sol_sh * tges,
sol_ref = albedo * sol_hor,
sol_bal = sol_hor - sol_ref,
)
View(everything)
ut <- 10.916667
gb <- 50.84050277777778
gl <- 8.683303333333333
doy <- 94
n <- doy
f <- pi/180   # Winkel in Radiant Faktor
#---------------------------Anweisungsteil
gbr <- gb*f
glr <- gl*f
#---------------------------Mittlere Sonnenzeit
t <- ut+gl/15.           # In Stunden
#---------------------------Stundenwinkel in Radiant
m <- 356.6+0.9856*n      # in Grad
m <- m*f                 # in Radiant
zt <- 0.1644*sin(2.*glr) - 0.1277*sin(m) # in Stunden
h <- (15.*f)*(t+zt-12.)  # In Radiant
#---------------------------Scheinb. geoz etc.
del <- 279.3*f+0.9856*f*n+1.92*f*sin(356.6*f+0.9856*f*n) #  in Radiant
#      del=del*f             #  in Radiant
#---------------------------Sinus Deklination der Sonne
sde <- sin(23.44*f)*sin(del)     #  In Radiant
#---------------------------Sonnenh?he
shh <- sin(gbr)*sde+cos(gbr)*cos(asin(sde))*cos(h)
sh <- asin(shh)/f;
f <- pi/180   # Winkel in Radiant Faktor
gbr <- gb*f
glr <- gl*f
#---------------------------Mittlere Sonnenzeit
t <- ut+gl/15.           # In Stunden
#---------------------------Stundenwinkel in Radiant
m <- 356.6+0.9856*n      # in Grad
m <- m*f                 # in Radiant
zt <- 0.1644*sin(2.*glr) - 0.1277*sin(m) # in Stunden
h <- (15.*f)*(t+zt-12.)  # In Radiant
#---------------------------Scheinb. geoz etc.
del <- 279.3*f+0.9856*f*n+1.92*f*sin(356.6*f+0.9856*f*n) #  in Radiant
#      del=del*f             #  in Radiant
#---------------------------Sinus Deklination der Sonne
sde <- sin(23.44*f)*sin(del)     #  In Radiant
saz=(sde*cos(gbr)-cos(asin(sde))*sin(gbr)*cos(h))/cos(shh)
saz=acos(saz)
saz <- saz/f;
library(lubridate)
library(dplyr)
source("../00_Toolbox/solar_IR_rad_functions.R")
radiation_data <- read.csv("../03_Sitzung_3/testdatensatz_radbilanz_wiese_caldern.csv") %>%
na.omit()
################# Notwendige Eingaben Atmosphäre
solconst <- 1367            # Mean solar constatnt W/m²
p <- 1000                   # Air pressure in hPa; wenn bekannt, angeben; sonst unten berechnen
oz <- 0.35                  # average Ozon columnar values 0.35 cm
t <- 20.8                   # Temperatur in °C
vis <- 40                   # horizontale Sichtweite in km
################### Notwendige Eingaben Ort und Zeit
gb <- 50.84050277777778
gl <- 8.683303333333333
################## Eingaben Gelaende
h  <- 200           # Gelaendehoehe in m
sky <- 0.8          # Himmelssichtfaktor (sky view factor 0..1); 1, wenn keine Horizontueberschattung; wenn nicht bekannt, rechnen
hex <- 180          # Expositionswinkel 0 = N, 180° = S
hn <- 20            # Hangneigung in Grad (0...90°)
albedo <- 0.15      # Albedo in 0...1
everything <- radiation_data %>%
mutate(
date = dmy_hm(datetime, tz = "Europe/Berlin"),
ut = hour(date)+minute(date)/60+second(date)/3600,
sh = sh(yday(date), ut, gb, gl),
pressure = pp(Ta_2m, h),
exz = exz(yday(date)),
saz = saz(yday(date), ut, gb, gl),
mr = mr(sh),
ma = ma(mr, pressure),
tlu = tlu(ma),
to3 = to3(mr, oz),
pw = pw(pressure,Ta_2m,h),
twv = twv(pw, mr),
tae = tae(vis, ma),
tgas = tgas(ma),
tges = tlu*to3*tgas*tae*twv,
sol_90 = solconst*exz,
sol_sh = sol_90 * sin(sh*(pi/180)),
sol_hor = sol_sh * tges,
sol_ref = albedo * sol_hor,
sol_bal = sol_hor - sol_ref,
)
View(everything)
yday(everything$date)
n <- 185
ut <- 4.25
gb <- 50.84050277777778
gl <- 8.683303333333333
f <- pi/180
everything <- radiation_data %>%
mutate(
date = dmy_hm(datetime, tz = "Europe/Berlin"),
ut = hour(date)+minute(date)/60+second(date)/3600,
sh = sh(yday(date), ut, gb, gl),
pressure = pp(Ta_2m, h),
exz = exz(yday(date)),
saz = saz(yday(date), ut, gb, gl, sh*f),
mr = mr(sh),
ma = ma(mr, pressure),
tlu = tlu(ma),
to3 = to3(mr, oz),
pw = pw(pressure,Ta_2m,h),
twv = twv(pw, mr),
tae = tae(vis, ma),
tgas = tgas(ma),
tges = tlu*to3*tgas*tae*twv,
sol_90 = solconst*exz,
sol_sh = sol_90 * sin(sh*(pi/180)),
sol_hor = sol_sh * tges,
sol_ref = albedo * sol_hor,
sol_bal = sol_hor - sol_ref,
)
radiation_data <- read.csv("../03_Sitzung_3/testdatensatz_radbilanz_wiese_caldern.csv") %>%
na.omit()
################# Notwendige Eingaben Atmosphäre
solconst <- 1367            # Mean solar constatnt W/m²
p <- 1000                   # Air pressure in hPa; wenn bekannt, angeben; sonst unten berechnen
oz <- 0.35                  # average Ozon columnar values 0.35 cm
t <- 20.8                   # Temperatur in °C
vis <- 40                   # horizontale Sichtweite in km
################### Notwendige Eingaben Ort und Zeit
gb <- 50.84050277777778
gl <- 8.683303333333333
################## Eingaben Gelaende
h  <- 200           # Gelaendehoehe in m
sky <- 0.8          # Himmelssichtfaktor (sky view factor 0..1); 1, wenn keine Horizontueberschattung; wenn nicht bekannt, rechnen
hex <- 180          # Expositionswinkel 0 = N, 180° = S
hn <- 20            # Hangneigung in Grad (0...90°)
albedo <- 0.15      # Albedo in 0...1
f <- pi/180
everything <- radiation_data %>%
mutate(
date = dmy_hm(datetime, tz = "Europe/Berlin"),
ut = hour(date)+minute(date)/60+second(date)/3600,
sh = sh(yday(date), ut, gb, gl),
pressure = pp(Ta_2m, h),
exz = exz(yday(date)),
saz = saz(yday(date), ut, gb, gl, (sh*f)),
mr = mr(sh),
ma = ma(mr, pressure),
tlu = tlu(ma),
to3 = to3(mr, oz),
pw = pw(pressure,Ta_2m,h),
twv = twv(pw, mr),
tae = tae(vis, ma),
tgas = tgas(ma),
tges = tlu*to3*tgas*tae*twv,
sol_90 = solconst*exz,
sol_sh = sol_90 * sin(sh*(pi/180)),
sol_hor = sol_sh * tges,
sol_ref = albedo * sol_hor,
sol_bal = sol_hor - sol_ref,
)
### Function Sonnenazimuth
saz <- function(n,ut,gb,gl, shh) {
f <- pi/180   # Winkel in Radiant Faktor
gbr <- gb*f
glr <- gl*f
#---------------------------Mittlere Sonnenzeit
t <- ut+gl/15.           # In Stunden
#---------------------------Stundenwinkel in Radiant
m <- 356.6+0.9856*n      # in Grad
m <- m*f                 # in Radiant
zt <- 0.1644*sin(2.*glr) - 0.1277*sin(m) # in Stunden
h <- (15.*f)*(t+zt-12.)  # In Radiant
#---------------------------Scheinb. geoz etc.
del <- 279.3*f+0.9856*f*n+1.92*f*sin(356.6*f+0.9856*f*n) #  in Radiant
#      del=del*f             #  in Radiant
#---------------------------Sinus Deklination der Sonne
sde <- sin(23.44*f)*sin(del)     #  In Radiant
#---------------------------Sonnenazimut
if(t <= 12) {
saz=(sde*cos(gbr)-cos(asin(sde))*sin(gbr)*cos(h))/cos(shh)
saz=acos(saz)
} else {
saz=(sde*cos(gbr)-cos(asin(sde))*sin(gbr)*cos(h))/cos(shh)
saz=360.*f-acos(saz) }
saz <- saz/f;
return(saz)
}
radiation_data <- read.csv("../03_Sitzung_3/testdatensatz_radbilanz_wiese_caldern.csv") %>%
na.omit()
################# Notwendige Eingaben Atmosphäre
solconst <- 1367            # Mean solar constatnt W/m²
p <- 1000                   # Air pressure in hPa; wenn bekannt, angeben; sonst unten berechnen
oz <- 0.35                  # average Ozon columnar values 0.35 cm
t <- 20.8                   # Temperatur in °C
vis <- 40                   # horizontale Sichtweite in km
################### Notwendige Eingaben Ort und Zeit
gb <- 50.84050277777778
gl <- 8.683303333333333
################## Eingaben Gelaende
h  <- 200           # Gelaendehoehe in m
sky <- 0.8          # Himmelssichtfaktor (sky view factor 0..1); 1, wenn keine Horizontueberschattung; wenn nicht bekannt, rechnen
hex <- 180          # Expositionswinkel 0 = N, 180° = S
hn <- 20            # Hangneigung in Grad (0...90°)
albedo <- 0.15      # Albedo in 0...1
f <- pi/180
everything <- radiation_data %>%
mutate(
date = dmy_hm(datetime, tz = "Europe/Berlin"),
ut = hour(date)+minute(date)/60+second(date)/3600,
sh = sh(yday(date), ut, gb, gl),
pressure = pp(Ta_2m, h),
exz = exz(yday(date)),
saz = saz(yday(date), ut, gb, gl, (sh*f)),
mr = mr(sh),
ma = ma(mr, pressure),
tlu = tlu(ma),
to3 = to3(mr, oz),
pw = pw(pressure,Ta_2m,h),
twv = twv(pw, mr),
tae = tae(vis, ma),
tgas = tgas(ma),
tges = tlu*to3*tgas*tae*twv,
sol_90 = solconst*exz,
sol_sh = sol_90 * sin(sh*(pi/180)),
sol_hor = sol_sh * tges,
sol_ref = albedo * sol_hor,
sol_bal = sol_hor - sol_ref,
)
?ifelse
### Function Sonnenazimuth
saz <- function(n,ut,gb,gl, shh) {
f <- pi/180   # Winkel in Radiant Faktor
gbr <- gb*f
glr <- gl*f
#---------------------------Mittlere Sonnenzeit
t <- ut+gl/15.           # In Stunden
#---------------------------Stundenwinkel in Radiant
m <- 356.6+0.9856*n      # in Grad
m <- m*f                 # in Radiant
zt <- 0.1644*sin(2.*glr) - 0.1277*sin(m) # in Stunden
h <- (15.*f)*(t+zt-12.)  # In Radiant
#---------------------------Scheinb. geoz etc.
del <- 279.3*f+0.9856*f*n+1.92*f*sin(356.6*f+0.9856*f*n) #  in Radiant
#      del=del*f             #  in Radiant
#---------------------------Sinus Deklination der Sonne
sde <- sin(23.44*f)*sin(del)     #  In Radiant
#---------------------------Sonnenazimut
saz <- (sde*cos(gbr)-cos(asin(sde))*sin(gbr)*cos(h))/cos(shh)
saz <- ifelse(t <=12, acos(saz), 360*f-acos(saz))
saz <- saz/f
return(saz)
}
radiation_data <- read.csv("../03_Sitzung_3/testdatensatz_radbilanz_wiese_caldern.csv") %>%
na.omit()
################# Notwendige Eingaben Atmosphäre
solconst <- 1367            # Mean solar constatnt W/m²
p <- 1000                   # Air pressure in hPa; wenn bekannt, angeben; sonst unten berechnen
oz <- 0.35                  # average Ozon columnar values 0.35 cm
t <- 20.8                   # Temperatur in °C
vis <- 40                   # horizontale Sichtweite in km
################### Notwendige Eingaben Ort und Zeit
gb <- 50.84050277777778
gl <- 8.683303333333333
################## Eingaben Gelaende
h  <- 200           # Gelaendehoehe in m
sky <- 0.8          # Himmelssichtfaktor (sky view factor 0..1); 1, wenn keine Horizontueberschattung; wenn nicht bekannt, rechnen
hex <- 180          # Expositionswinkel 0 = N, 180° = S
hn <- 20            # Hangneigung in Grad (0...90°)
albedo <- 0.15      # Albedo in 0...1
f <- pi/180
everything <- radiation_data %>%
mutate(
date = dmy_hm(datetime, tz = "Europe/Berlin"),
ut = hour(date)+minute(date)/60+second(date)/3600,
sh = sh(yday(date), ut, gb, gl),
pressure = pp(Ta_2m, h),
exz = exz(yday(date)),
saz = saz(yday(date), ut, gb, gl, (sh*f)),
mr = mr(sh),
ma = ma(mr, pressure),
tlu = tlu(ma),
to3 = to3(mr, oz),
pw = pw(pressure,Ta_2m,h),
twv = twv(pw, mr),
tae = tae(vis, ma),
tgas = tgas(ma),
tges = tlu*to3*tgas*tae*twv,
sol_90 = solconst*exz,
sol_sh = sol_90 * sin(sh*(pi/180)),
sol_hor = sol_sh * tges,
sol_ref = albedo * sol_hor,
sol_bal = sol_hor - sol_ref,
)
usethis::use_r("radiation")
az <- c(0,45,90,135,180,225,270,315)
th <- c(25, 30, 30, 11, 12, 17, 15 ,10)
dist <- c(154.6, 84.5, 64.0, 47.7, 66.7, 55.6, 34.0, 32.0)
nl <- length(az)
az <- c(0,45,90,135,180,225,270,315)
th <- c(25, 30, 30, 11, 12, 17, 15 ,10)
dist <- c(154.6, 84.5, 64.0, 47.7, 66.7, 55.6, 34.0, 32.0)
nl <- length(az)
s_al <- vector(mode="numeric", length = nl)
sky_vaz <- vector(mode="numeric", length = nl)
s_al <- asin(th/dist)   # sin(alpha) nach Pythagoras
az <- c(0,45,90,135,180,225,270,315)
th <- c(25, 30, 30, 11, 12, 17, 15 ,10)
dist <- c(154.6, 84.5, 64.0, 47.7, 66.7, 55.6, 34.0, 32.0)
nl <- length(az)
s_al <- asin(th/dist)   # sin(alpha) nach Pythagoras
sky_vaz <- (1-cos(s_al))
devtools::load_all()
devtools::load_all()
devtools::load_all()
devtools::document()
devtools::document()
devtools::load_all()
devtools::document()
?lw_emissivity_air
usethis
usethis::use_r("latent")
usethis::use_r("sensible")
