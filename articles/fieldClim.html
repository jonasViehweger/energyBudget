<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to fieldClim • fieldClim</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to fieldClim">
<meta property="og:description" content="fieldClim">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fieldClim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/fieldClim.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="fieldClim_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to fieldClim</h1>
            
            <h4 class="date">2020-09-08</h4>
      
      
      <div class="hidden name"><code>fieldClim.Rmd</code></div>

    </div>

    
    
<div id="introduction-to-the-package" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction-to-the-package" class="anchor"></a>Introduction to the Package</h2>
<p>The <code>fieldClim</code> package was originally designed as a course project to the course <code>Geländeklimatologie</code>, held by Prof. Dr. Jörg Bendix at the Philipps-University of Marburg in summer term 2020. Thus, the calculations and formulas of this package are based on this course, as well as the book <code>Geländeklimatologie</code> (Field climatology) by Jörg Bendix (2004; ISBN 978-3-443-07139-4).</p>
<p><code>fieldClim</code> is designed as a handy tool, that lets you calculate various weather and micro-climate conditions, based on the measurements of a weather station. It lets you create a <code>weather_station</code>-object, that can then be used to call most of the functions without the necessity of further specify input variables. In addition, all functions can also be called by manually inputting the needed variables, if the user wishes to do so.</p>
<p>Here, we will provide an example of the calculation of a set of micro-climate conditions using the <code>weather_station</code>-object, based on the <code>weather_station_example_data</code> data frame, that is included in the package.</p>
</div>
<div id="preparing-the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#preparing-the-data" class="anchor"></a>Preparing the data</h2>
<p>First let’s load the package and the provided example-data and take a look at the provided columns.</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw">fieldClim</span>)
<span class="kw">ws</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/get.html">get</a></span>(<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="kw">weather_station_example_data</span>, package=<span class="st">"fieldClim"</span>))

<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="kw">ws</span>)
<span class="co">#&gt;  [1] "datetime"       "t1"             "hum1"           "t2"            </span>
<span class="co">#&gt;  [5] "hum2"           "rad_sw_in"      "rad_sw_out"     "rad_lw_in"     </span>
<span class="co">#&gt;  [9] "rad_lw_out"     "rad_sw_bal"     "rad_lw_bal"     "albedo"        </span>
<span class="co">#&gt; [13] "rad_bal"        "water_vol_soil" "ts1"            "heatflux_soil" </span>
<span class="co">#&gt; [17] "v1"             "v2"             "t_surface"      "p1"            </span>
<span class="co">#&gt; [21] "p2"</span>
</pre></div>
<p>This dataset includes most of the data necessary to run the functions in this package.</p>
<p>Before building a <code>weather_station</code> object it is necessary to ensure that the input is properly formatted. For this we need to check if the <code>datetime</code> column is in <code>POSIXt</code>-format and if not convert it.</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="co"># Check datetime class</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span>(<span class="kw">ws</span><span class="op">$</span><span class="kw">datetime</span>)
<span class="co">#&gt; [1] "POSIXlt" "POSIXt"</span>

<span class="co"># Looks good! However just to demonstrate here's how to convert to POSIXt:</span>
<span class="kw">wrong_type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="kw">ws</span><span class="op">$</span><span class="kw">datetime</span>)
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span>(<span class="kw">wrong_type</span>)
<span class="co">#&gt; [1] "character"</span>

<span class="co"># convert with</span>
<span class="kw">ws</span><span class="op">$</span><span class="kw">datetime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strptime.html">strptime</a></span>(<span class="kw">wrong_type</span>, format = <span class="st">"%Y-%m-%d %H:%M:%S"</span>)
<span class="co"># or</span>
<span class="kw">ws</span><span class="op">$</span><span class="kw">datetime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXlt</a></span>(<span class="kw">wrong_type</span>)
</pre></div>
<p>It is also necessary to check if all other columns containing data are <code>numeric</code>. Most functions provided by <code>fieldClim</code> require <code>numeric</code> input. Some functions will automatically try to convert to <code>numeric</code>, however this will sometimes lead to unexpected side-effects so it is always best to ensure the proper data format for yourself.</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="co"># Check if any remaining classes are not numeric</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Filter</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Negate</a></span>(<span class="kw">is.numeric</span>), <span class="kw">ws</span>))
<span class="co">#&gt; [1] "datetime"</span>
</pre></div>
<p>Looks like only the <code>datetime</code> column is not numeric which is appropriate. If this wasn’t the case, other columns might have to be converted using <code><a href="https://rdrr.io/r/base/numeric.html">as.numeric()</a></code>.</p>
</div>
<div id="building-a-weather_station-object" class="section level2">
<h2 class="hasAnchor">
<a href="#building-a-weather_station-object" class="anchor"></a>Building a weather_station object</h2>
<p>If the dataframe is properly formatted (date column as <code>POSIXt</code>, all other necessary columns <code>numeric</code>), the function <code><a href="../reference/build_weather_station.html">build_weather_station()</a></code> can be used to conveniently create a <code>weather_station</code> object.</p>
<p>You can get more info about the single parameters by calling <code><a href="../reference/build_weather_station.html">?build_weather_station</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="kw">test_station</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_weather_station.html">build_weather_station</a></span>(lat = <span class="fl">50.840503</span>,
                                      lon = <span class="fl">8.6833</span>,
                                      elev = <span class="fl">270</span>,
                                      surface_type = <span class="st">"Meadow"</span>,
                                      obs_height = <span class="fl">0.3</span>, <span class="co"># obstacle height</span>
                                      z1 = <span class="fl">2</span>, <span class="co"># measurement heights</span>
                                      z2 = <span class="fl">10</span>,
                                      datetime = <span class="kw">ws</span><span class="op">$</span><span class="kw">datetime</span>,
                                      t1 = <span class="kw">ws</span><span class="op">$</span><span class="kw">t1</span>, <span class="co"># temperature</span>
                                      t2 = <span class="kw">ws</span><span class="op">$</span><span class="kw">t2</span>,
                                      v1 = <span class="kw">ws</span><span class="op">$</span><span class="kw">v1</span>, <span class="co"># windspeed</span>
                                      v2 = <span class="kw">ws</span><span class="op">$</span><span class="kw">v2</span>,
                                      hum1 = <span class="kw">ws</span><span class="op">$</span><span class="kw">hum1</span>, <span class="co"># humidity</span>
                                      hum2 = <span class="kw">ws</span><span class="op">$</span><span class="kw">hum2</span>,
                                      sw_in = <span class="kw">ws</span><span class="op">$</span><span class="kw">rad_sw_in</span>, <span class="co"># shortwave radiation</span>
                                      sw_out = <span class="kw">ws</span><span class="op">$</span><span class="kw">rad_sw_out</span>,
                                      lw_in = <span class="kw">ws</span><span class="op">$</span><span class="kw">rad_lw_in</span>, <span class="co"># longwave radiation</span>
                                      lw_out = <span class="kw">ws</span><span class="op">$</span><span class="kw">rad_lw_out</span>,
                                      soil_flux = <span class="kw">ws</span><span class="op">$</span><span class="kw">heatflux_soil</span>)

<span class="co"># We can see that this is indeed a weather_station object.</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span>(<span class="kw">test_station</span>)
<span class="co">#&gt; [1] "weather_station"</span>
</pre></div>
<p>This is close to the minimum amount of parameters necessary to build a <code>weather_station</code> object.</p>
<p>Many of the parameters can however also be estimated using different inputs. Below is an overview on which parameters can be omitted or estimated another way.</p>
<div id="adding-air-pressure" class="section level3">
<h3 class="hasAnchor">
<a href="#adding-air-pressure" class="anchor"></a>Adding air pressure</h3>
<p>By default the air pressure at the measurment heights is estimated using the temperature and the elevation (using <code><a href="../reference/pres_p.html">pres_p()</a></code>). If the pressure is measured at the weather station it can be added to the call using the parameters <code>p1</code> and <code>p2</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="kw">test_station</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_weather_station.html">build_weather_station</a></span>(lat = <span class="fl">50.840503</span>,
                                      lon = <span class="fl">8.6833</span>,
                                      elev = <span class="fl">270</span>,
                                      surface_type = <span class="st">"Meadow"</span>,
                                      obs_height = <span class="fl">0.3</span>,
                                      z1 = <span class="fl">2</span>,
                                      z2 = <span class="fl">10</span>,
                                      datetime = <span class="kw">ws</span><span class="op">$</span><span class="kw">datetime</span>,
                                      t1 = <span class="kw">ws</span><span class="op">$</span><span class="kw">t1</span>,
                                      t2 = <span class="kw">ws</span><span class="op">$</span><span class="kw">t2</span>,
                                      v1 = <span class="kw">ws</span><span class="op">$</span><span class="kw">v1</span>,
                                      v2 = <span class="kw">ws</span><span class="op">$</span><span class="kw">v2</span>,
                                      hum1 = <span class="kw">ws</span><span class="op">$</span><span class="kw">hum1</span>,
                                      hum2 = <span class="kw">ws</span><span class="op">$</span><span class="kw">hum2</span>,
                                      sw_in = <span class="kw">ws</span><span class="op">$</span><span class="kw">rad_sw_in</span>,
                                      sw_out = <span class="kw">ws</span><span class="op">$</span><span class="kw">rad_sw_out</span>,
                                      lw_in = <span class="kw">ws</span><span class="op">$</span><span class="kw">rad_lw_in</span>,
                                      lw_out = <span class="kw">ws</span><span class="op">$</span><span class="kw">rad_lw_out</span>,
                                      soil_flux = <span class="kw">ws</span><span class="op">$</span><span class="kw">heatflux_soil</span>,
                                      <span class="co"># ADDED PRESSURE</span>
                                      p1 = <span class="kw">ws</span><span class="op">$</span><span class="kw">p1</span>,
                                      p2 = <span class="kw">ws</span><span class="op">$</span><span class="kw">p2</span>)
</pre></div>
<p>Note: If the pressure at the station is only measured at one height, it will also be applied to the other height since the measured pressure is assumed to be much more accurate than the estimated pressure.</p>
</div>
<div id="missing-soil-flux" class="section level3">
<h3 class="hasAnchor">
<a href="#missing-soil-flux" class="anchor"></a>Missing soil flux</h3>
<p>If the soil flux is not measured by a heat flux plate but by two soil temperature measurements at different depths, those measurements can also be provided to calculate <code>soil_flux</code> from them instead.</p>
<p>For this the two depths of the temperature probes from the surface in meters, the two temperature measurements in degrees Celsius as well as the soil texture (“clay” or “sand”) and soil moisture (Vol-%) are necessary.</p>
<p>Internally the calculations are provided by the two functions <code><a href="../reference/soil_heat_flux.html">soil_heat_flux()</a></code> and <code><a href="../reference/soil_thermal_cond.html">soil_thermal_cond()</a></code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="kw">test_station</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_weather_station.html">build_weather_station</a></span>(lat = <span class="fl">50.840503</span>,
                                      lon = <span class="fl">8.6833</span>,
                                      elev = <span class="fl">270</span>,
                                      surface_type = <span class="st">"Meadow"</span>,
                                      obs_height = <span class="fl">0.3</span>,
                                      z1 = <span class="fl">2</span>,
                                      z2 = <span class="fl">10</span>,
                                      datetime = <span class="kw">ws</span><span class="op">$</span><span class="kw">datetime</span>,
                                      t1 = <span class="kw">ws</span><span class="op">$</span><span class="kw">t1</span>,
                                      t2 = <span class="kw">ws</span><span class="op">$</span><span class="kw">t2</span>,
                                      v1 = <span class="kw">ws</span><span class="op">$</span><span class="kw">v1</span>,
                                      v2 = <span class="kw">ws</span><span class="op">$</span><span class="kw">v2</span>,
                                      hum1 = <span class="kw">ws</span><span class="op">$</span><span class="kw">hum1</span>,
                                      hum2 = <span class="kw">ws</span><span class="op">$</span><span class="kw">hum2</span>,
                                      sw_in = <span class="kw">ws</span><span class="op">$</span><span class="kw">rad_sw_in</span>,
                                      sw_out = <span class="kw">ws</span><span class="op">$</span><span class="kw">rad_sw_out</span>,
                                      lw_in = <span class="kw">ws</span><span class="op">$</span><span class="kw">rad_lw_in</span>,
                                      lw_out = <span class="kw">ws</span><span class="op">$</span><span class="kw">rad_lw_out</span>,
                                      <span class="co"># Alternative Soil flux:</span>
                                      depth1 = <span class="fl">0</span>,
                                      depth2 = <span class="fl">0.3</span>,
                                      ts1 = <span class="kw">ws</span><span class="op">$</span><span class="kw">t_surface</span>,
                                      ts2 = <span class="kw">ws</span><span class="op">$</span><span class="kw">ts1</span>,
                                      moisture = <span class="kw">ws</span><span class="op">$</span><span class="kw">water_vol_soil</span>,
                                      texture = <span class="st">"clay"</span>)
</pre></div>
</div>
<div id="missing-shortwave-radiation" class="section level3">
<h3 class="hasAnchor">
<a href="#missing-shortwave-radiation" class="anchor"></a>Missing shortwave radiation</h3>
<p>The two shortwave inputs <code>sw_in</code> and <code>sw_out</code> can be estimated by instead providing the parameter <code>albedo</code>.</p>
<p>This works by estimating the top of atmosphere radiation at the provided location, time and date as well as the average atmospheric transmittance (see <code><a href="../reference/rad_sw_in.html">?rad_sw_in</a></code>).</p>
<p>By setting <code>slope</code>, <code>sky_view</code> and <code>exposition</code>, <code>sw_in</code> and <code>sw_out</code> will additionally be topographically corrected (see <code><a href="../reference/rad_sw_in_topo.html">?rad_sw_in_topo</a></code>).</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="kw">test_station</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_weather_station.html">build_weather_station</a></span>(lat = <span class="fl">50.840503</span>,
                                      lon = <span class="fl">8.6833</span>,
                                      elev = <span class="fl">270</span>,
                                      surface_type = <span class="st">"Meadow"</span>,
                                      obs_height = <span class="fl">0.3</span>,
                                      z1 = <span class="fl">2</span>,
                                      z2 = <span class="fl">10</span>,
                                      datetime = <span class="kw">ws</span><span class="op">$</span><span class="kw">datetime</span>,
                                      t1 = <span class="kw">ws</span><span class="op">$</span><span class="kw">t1</span>,
                                      t2 = <span class="kw">ws</span><span class="op">$</span><span class="kw">t2</span>,
                                      v1 = <span class="kw">ws</span><span class="op">$</span><span class="kw">v1</span>,
                                      v2 = <span class="kw">ws</span><span class="op">$</span><span class="kw">v2</span>,
                                      hum1 = <span class="kw">ws</span><span class="op">$</span><span class="kw">hum1</span>,
                                      hum2 = <span class="kw">ws</span><span class="op">$</span><span class="kw">hum2</span>,
                                      lw_in = <span class="kw">ws</span><span class="op">$</span><span class="kw">rad_lw_in</span>,
                                      lw_out = <span class="kw">ws</span><span class="op">$</span><span class="kw">rad_lw_out</span>,
                                      soil_flux = <span class="kw">ws</span><span class="op">$</span><span class="kw">heatflux_soil</span>,
                                      <span class="co"># Alternative shortwave radiation:</span>
                                      albedo = <span class="fl">0.3</span>,
                                      <span class="co"># Topographic correction</span>
                                      slope = <span class="fl">10</span>, <span class="co"># In degrees</span>
                                      exposition = <span class="fl">20</span>, <span class="co"># North = 0, South = 180</span>
                                      sky_view = <span class="fl">0.82</span> <span class="co"># Sky view factor (0-1)</span>
                                      )
</pre></div>
</div>
<div id="missing-longwave-radiation" class="section level3">
<h3 class="hasAnchor">
<a href="#missing-longwave-radiation" class="anchor"></a>Missing longwave radiation</h3>
<p>If <code>lw_in</code> is not provided, it will get estimated using the air temperature and air pressure (see <code><a href="../reference/rad_lw_in.html">?rad_lw_in</a></code>). By setting <code>sky_view</code>, <code>lw_in</code> will be topographically corrected (see <code><a href="../reference/rad_sw_in_topo.html">?rad_sw_in_topo</a></code>).</p>
<p>If <code>lw_out</code> is not provided, the surface temperature needs to be set as <code>t_surface</code> (see <code><a href="../reference/rad_lw_out.html">?rad_lw_out</a></code>). The surface temperature and emissivity get combined to estimate the longwave emissions. The default emissivity used in <code><a href="../reference/build_weather_station.html">build_weather_station()</a></code> is the one for short grass (0.95). If a different emissivity is needed, <code><a href="../reference/rad_lw_out.html">rad_lw_out()</a></code> can be used directly.</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="kw">test_station</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_weather_station.html">build_weather_station</a></span>(lat = <span class="fl">50.840503</span>,
                                      lon = <span class="fl">8.6833</span>,
                                      elev = <span class="fl">270</span>,
                                      surface_type = <span class="st">"Meadow"</span>,
                                      obs_height = <span class="fl">0.3</span>,
                                      z1 = <span class="fl">2</span>,
                                      z2 = <span class="fl">10</span>,
                                      datetime = <span class="kw">ws</span><span class="op">$</span><span class="kw">datetime</span>,
                                      t1 = <span class="kw">ws</span><span class="op">$</span><span class="kw">t1</span>,
                                      t2 = <span class="kw">ws</span><span class="op">$</span><span class="kw">t2</span>,
                                      v1 = <span class="kw">ws</span><span class="op">$</span><span class="kw">v1</span>,
                                      v2 = <span class="kw">ws</span><span class="op">$</span><span class="kw">v2</span>,
                                      hum1 = <span class="kw">ws</span><span class="op">$</span><span class="kw">hum1</span>,
                                      hum2 = <span class="kw">ws</span><span class="op">$</span><span class="kw">hum2</span>,
                                      sw_in = <span class="kw">ws</span><span class="op">$</span><span class="kw">rad_sw_in</span>,
                                      sw_out = <span class="kw">ws</span><span class="op">$</span><span class="kw">rad_sw_out</span>,
                                      soil_flux = <span class="kw">ws</span><span class="op">$</span><span class="kw">heatflux_soil</span>,
                                      <span class="co"># Alternative longwave radiation:</span>
                                      t_surface = <span class="kw">ws</span><span class="op">$</span><span class="kw">t_surface</span>,
                                      <span class="co"># Different emissivity:</span>
                                      <span class="co"># lw_out = rad_lw_out(ws$t_surface, emissivity_surface = 0.92),</span>
                                      <span class="co"># Topographic correction</span>
                                      sky_view = <span class="fl">0.82</span> <span class="co"># Sky view factor (0-1)</span>
                                      )
</pre></div>
</div>
</div>
<div id="calculations-using-the-provided-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#calculations-using-the-provided-functions" class="anchor"></a>Calculations using the provided functions</h2>
<p>Most functions can be called in two different ways. Either by passing all the needed data yourself, or by passing a <code>weather_station</code> object. Let’s see how this works by calculating the Gradient-Richardson-Number.</p>
<p>First let’s calculate it by passing the needed parameters ourselves:</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="kw">grad_rich_manual</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/turb_flux_grad_rich_no.html">turb_flux_grad_rich_no</a></span>(t1 = <span class="kw">ws</span><span class="op">$</span><span class="kw">t1</span>, 
                                           t2 = <span class="kw">ws</span><span class="op">$</span><span class="kw">t2</span>, 
                                           z1 = <span class="fl">2</span>, 
                                           z2 = <span class="fl">10</span>, 
                                           v1 = <span class="kw">ws</span><span class="op">$</span><span class="kw">v1</span>, 
                                           v2 = <span class="kw">ws</span><span class="op">$</span><span class="kw">v2</span>, 
                                           p1 = <span class="fu"><a href="../reference/pres_p.html">pres_p</a></span>(<span class="fl">270</span><span class="op">+</span><span class="fl">2</span>, <span class="kw">ws</span><span class="op">$</span><span class="kw">t1</span>), 
                                           p2 = <span class="fu"><a href="../reference/pres_p.html">pres_p</a></span>(<span class="fl">270</span><span class="op">+</span><span class="fl">10</span>, <span class="kw">ws</span><span class="op">$</span><span class="kw">t2</span>))

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">grad_rich_manual</span>)
<span class="co">#&gt; [1] 121.63179  62.34312  53.80912  53.30846 105.05975 223.87416</span>
</pre></div>
<p>As you can see it is quite the effort to get all the appropriate parameters. You even have to calculate some additional ones (like <code>p1</code>, <code>p2</code> in this example) beforehand if they are not available.</p>
<p>So instead it is a lot more comfortable to use a <code>weather_station</code> object. Here we use the object we have defined earlier:</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="kw">grad_rich_quick</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/turb_flux_grad_rich_no.html">turb_flux_grad_rich_no</a></span>(<span class="kw">test_station</span>)

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">grad_rich_quick</span>)
<span class="co">#&gt; [1] 121.63179  62.34312  53.80912  53.30846 105.05975 223.87416</span>
</pre></div>
<p>As you can see the results are exactly the same, but using the <code>weather_station</code> object is much more convenient.</p>
</div>
<div id="calculating-turbulent-fluxes" class="section level2">
<h2 class="hasAnchor">
<a href="#calculating-turbulent-fluxes" class="anchor"></a>Calculating Turbulent Fluxes</h2>
<p>A convenience function to calculate all the different methods for turbulent fluxes is given in <code><a href="../reference/turb_flux_calc.html">turb_flux_calc()</a></code>. This function is only available for <code>weather_station</code> objects as it returns the results straight into the given <code>weather_station</code>. The <code>water</code> package also has to be installed for this function to work.</p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="kw">station_turbulent</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/turb_flux_calc.html">turb_flux_calc</a></span>(<span class="kw">test_station</span>)

<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw">station_turbulent</span><span class="op">$</span><span class="kw">measurements</span>)
<span class="co">#&gt;  [1] "datetime"                  "t1"                       </span>
<span class="co">#&gt;  [3] "t2"                        "v1"                       </span>
<span class="co">#&gt;  [5] "v2"                        "hum1"                     </span>
<span class="co">#&gt;  [7] "hum2"                      "p1"                       </span>
<span class="co">#&gt;  [9] "p2"                        "sw_in"                    </span>
<span class="co">#&gt; [11] "sw_out"                    "lw_in"                    </span>
<span class="co">#&gt; [13] "lw_out"                    "soil_flux"                </span>
<span class="co">#&gt; [15] "t_surface"                 "sw_bal"                   </span>
<span class="co">#&gt; [17] "lw_bal"                    "rad_bal"                  </span>
<span class="co">#&gt; [19] "stability"                 "sensible_priestley_taylor"</span>
<span class="co">#&gt; [21] "latent_priestley_taylor"   "sensible_bowen"           </span>
<span class="co">#&gt; [23] "latent_bowen"              "sensible_monin"           </span>
<span class="co">#&gt; [25] "latent_monin"              "latent_penman"</span>
</pre></div>
<p>You can see that now there are all results from the different methods to calculate the turbulent fluxes available in the measurement list of the weather_station object.</p>
</div>
<div id="convert-to-a-dataframe" class="section level2">
<h2 class="hasAnchor">
<a href="#convert-to-a-dataframe" class="anchor"></a>Convert to a dataframe</h2>
<p>You can easily convert a <code>weather_station</code> object to a data frame by using the generic function <code>as.data.frame</code>. This converts all the entries in the <code>measurements</code> list of the object into a dataframe.</p>
<p>There are also two additional toggles that can be set, called <code>reduced</code> and <code>unit</code>. <code>reduced</code> will omit some (very few) columns which aren’t used often. <code>unit</code> will add longer column names with the correct units to all columns available with <code>reduced = TRUE</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit">

<span class="kw">normal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="kw">station_turbulent</span>)
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="kw">normal</span>)
<span class="co">#&gt;  [1] "datetime"                  "t1"                       </span>
<span class="co">#&gt;  [3] "t2"                        "v1"                       </span>
<span class="co">#&gt;  [5] "v2"                        "hum1"                     </span>
<span class="co">#&gt;  [7] "hum2"                      "p1"                       </span>
<span class="co">#&gt;  [9] "p2"                        "sw_in"                    </span>
<span class="co">#&gt; [11] "sw_out"                    "lw_in"                    </span>
<span class="co">#&gt; [13] "lw_out"                    "soil_flux"                </span>
<span class="co">#&gt; [15] "t_surface"                 "sw_bal"                   </span>
<span class="co">#&gt; [17] "lw_bal"                    "rad_bal"                  </span>
<span class="co">#&gt; [19] "stability"                 "sensible_priestley_taylor"</span>
<span class="co">#&gt; [21] "latent_priestley_taylor"   "sensible_bowen"           </span>
<span class="co">#&gt; [23] "latent_bowen"              "sensible_monin"           </span>
<span class="co">#&gt; [25] "latent_monin"              "latent_penman"</span>

<span class="kw">reduced</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="kw">station_turbulent</span>, reduced = <span class="kw">T</span>)
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="kw">reduced</span>)
<span class="co">#&gt;  [1] "datetime"                  "t1"                       </span>
<span class="co">#&gt;  [3] "t2"                        "v1"                       </span>
<span class="co">#&gt;  [5] "v2"                        "p1"                       </span>
<span class="co">#&gt;  [7] "p2"                        "hum1"                     </span>
<span class="co">#&gt;  [9] "hum2"                      "soil_flux"                </span>
<span class="co">#&gt; [11] "sw_in"                     "sw_out"                   </span>
<span class="co">#&gt; [13] "lw_in"                     "lw_out"                   </span>
<span class="co">#&gt; [15] "sw_bal"                    "lw_bal"                   </span>
<span class="co">#&gt; [17] "rad_bal"                   "stability"                </span>
<span class="co">#&gt; [19] "sensible_priestley_taylor" "latent_priestley_taylor"  </span>
<span class="co">#&gt; [21] "sensible_bowen"            "latent_bowen"             </span>
<span class="co">#&gt; [23] "sensible_monin"            "latent_monin"             </span>
<span class="co">#&gt; [25] "latent_penman"</span>

<span class="kw">unit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="kw">station_turbulent</span>, reduced = <span class="kw">T</span>, unit = <span class="kw">T</span>)
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="kw">unit</span>)
<span class="co">#&gt;  [1] "datetime"                            </span>
<span class="co">#&gt;  [2] "temperature_lower[degC]"             </span>
<span class="co">#&gt;  [3] "temperature_upper[degC]"             </span>
<span class="co">#&gt;  [4] "wind_speed_lower[m/s]"               </span>
<span class="co">#&gt;  [5] "wind_speed_upper[m/s]"               </span>
<span class="co">#&gt;  [6] "pressure_lower[hPa]"                 </span>
<span class="co">#&gt;  [7] "pressure_upper[hPa]"                 </span>
<span class="co">#&gt;  [8] "humidity_lower[%]"                   </span>
<span class="co">#&gt;  [9] "humidity_upper[%]"                   </span>
<span class="co">#&gt; [10] "soil_flux[W/m^2]"                    </span>
<span class="co">#&gt; [11] "shortwave_radiation_in[W/m^2]"       </span>
<span class="co">#&gt; [12] "shortwave_radiation_out[W/m^2]"      </span>
<span class="co">#&gt; [13] "longwave_radiation_in[W/m^2]"        </span>
<span class="co">#&gt; [14] "longwave_radiation_out[W/m^2]"       </span>
<span class="co">#&gt; [15] "shortwave_radiation_balance[W/m^2]"  </span>
<span class="co">#&gt; [16] "longwave_radiation_balance[W/m^2]"   </span>
<span class="co">#&gt; [17] "total_radiation_balance[W/m^2]"      </span>
<span class="co">#&gt; [18] "atmospheric_stability"               </span>
<span class="co">#&gt; [19] "sensible_heat[W/m^2]_Priestly-Taylor"</span>
<span class="co">#&gt; [20] "latent_heat[W/m^2]_Priestly-Taylor"  </span>
<span class="co">#&gt; [21] "sensible_heat[W/m^2]_Bowen"          </span>
<span class="co">#&gt; [22] "latent_heat[W/m^2]_Bowen"            </span>
<span class="co">#&gt; [23] "sensible_heat[W/m^2]_Monin"          </span>
<span class="co">#&gt; [24] "latent_heat[W/m^2]_Monin"            </span>
<span class="co">#&gt; [25] "latent_heat[W/m^2]_Penman"</span>
</pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by David Langenohl, Jonas Viehweger, Jörg Bendix.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.0.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
